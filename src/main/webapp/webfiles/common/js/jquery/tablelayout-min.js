function tblMouseXY(a){a=a||window.event;var c=null,b=null;c=a.pageX||(a.clientX+(document.documentElement.scrollLeft||document.body.scrollLeft));b=a.pageY||(a.clientY+(document.documentElement.scrollTop||document.body.scrollTop));return{x:c,y:b}}function tblClearEvent(a){if(a.stopPropagation){a.stopPropagation()}else{a.cancelBubble=true}if(a.preventDefault){a.preventDefault()}else{a.returnValue=false}}function TableLayout(f){this.type=f.type;this.region=f.region;this.resizeBar=f.resizeBar;this.resizeArea=f.resizeArea;this.toggle=(typeof f.toggle=="boolean")?f.toggle:false;this.visible=(typeof f.visible=="boolean")?f.visible:true;this.minWidth=f.minWidth||50;this.maxWidth=f.maxWidth;this.minHeight=f.minHeight||50;this.maxHeight=f.maxHeight;this.resizeMove=false;this.resizeBarId="_resizeBar_"+this.resizeBar;this.offsetL=0;this.offsetT=0;this.startX=0;this.startY=0;this.resizeBarObj=null;this.resizeAreaObj=null;if(this.type!="V"&&this.type!="H"){alert("TableLayout的type定义错误，其值是：V | H ！");return}if(this.region!="left"&&this.region!="right"&&this.region!="top"&&this.region!="bottom"){alert("TableLayout的region定义错误，其值是：left | right | top | bottom ！");return}if(!this.resizeBar||!document.getElementById(this.resizeBar)){alert("TableLayout无法发现定义的 resizeBar !");return}if(!this.resizeArea||!document.getElementById(this.resizeArea)){alert("TableLayout无法发现定义的 resizeArea 区域 !");return}var a=this,b=null,d=null;b=a.type=="V"?"VTblResizeBar":(a.type=="H"?"HTblResizeBar":"");d=a.type=="V"?"width":(a.type=="H"?"height":"");$("#"+a.resizeBar).removeAttr(d).addClass(b).bind("mousedown",{tbl:a},a.resizeStart);if(a.type=="V"){var c=$("#"+a.resizeArea).width();$("#"+a.resizeArea).css({width:c+"px"}).removeAttr("width")}else{var e=$("#"+a.resizeArea).height();$("#"+a.resizeArea).css({height:e+"px"}).removeAttr("height")}if(!a.visible){if(a.type=="V"){$("#"+a.resizeArea).hide()}else{if(a.type=="H"){$("#"+a.resizeArea).parent("tr").hide()}}}if(a.toggle){$("#"+a.resizeBar).html('<div id="'+a.resizeBar+'-tib" class="'+(a.getToggleClass())+'"></div>');$("#"+a.resizeBar+"-tib").bind("click",function(){if(a.type=="V"){$("#"+a.resizeArea).toggle()}else{if(a.type=="H"){$("#"+a.resizeArea).parent("tr").toggle()}}$(this)[0].className=a.getToggleClass()})}$("#"+a.resizeBar).children().bind("mousedown",function(g){tblClearEvent(g);return false});d=null;b=null}TableLayout.prototype.getToggleClass=function(){var b="",a=this;if(a.type=="V"){if($("#"+a.resizeArea).css("display")=="none"){b=(a.region=="left"?"toggle-img-v-tor":"toggle-img-v-tol")}else{b=(a.region=="left"?"toggle-img-v-tol":"toggle-img-v-tor")}}else{if(a.type=="H"){if($("#"+a.resizeArea).parent("tr").css("display")=="none"){b=(a.region=="top"?"toggle-img-h-tod":"toggle-img-h-tou")}else{b=(a.region=="top"?"toggle-img-h-tou":"toggle-img-h-tod")}}}return b};TableLayout.prototype.resizeStart=function(j){var f=null,i=null,g=null,b=null,k=null,h=null,c=null,a=null;try{f=j.data.tbl;if($("#"+f.resizeArea).css("display")=="none"||$("#"+f.resizeArea).parent("tr").css("display")=="none"){return}i=f.resizeBarId;if(!document.getElementById("tbl_resize_layer")){$(document.body).append("<div id='tbl_resize_layer' class='tbl-resize-layer'></div>")}$("#tbl_resize_layer").show();if(!document.getElementById(i)){a=f.type=="V"?"tbl-rb-v":(f.type=="H"?"tbl-rb-h":"");$(document.body).append("<div id='"+i+"' class='tbl-resize-bar "+a+"'></div>")}g=$("#"+f.resizeBar);b=g.offset().left;k=g.offset().top;h=g.width();c=g.height();f.offsetL=b;f.offsetT=k;f.startX=tblMouseXY(j).x;f.startY=tblMouseXY(j).y;$("#"+i).css({left:b+"px",top:k+"px",width:h+"px",height:c+"px"}).show();$(document).bind("mousemove",{tbl:f},f.resizeDoing);$(document).bind("mouseup",{tbl:f},f.resizeEnd);tblClearEvent(j);return false}catch(d){}finally{a=null;c=null;h=null;k=null;b=null;g=null;i=null;f=null}};TableLayout.prototype.resizeDoing=function(g){var d=null,j=null,h=null,f=null,b=null,a=null,k=null,i=null;try{d=g.data.tbl;if(!d.resizeMove){d.resizeMove=true}j=tblMouseXY(g);if(d.type=="H"){i=d.offsetT+j.y-d.startY;if(d.minHeight||d.maxHeight){b=d.region=="top"?(i-d.offsetT):(d.offsetT-i);a=$("#"+d.resizeArea).height()+b;if(a<=d.minHeight||a>=d.maxHeight){return}}$("#"+d.resizeBarId).css({top:i+"px"})}else{if(d.type=="V"){k=d.offsetL+j.x-d.startX;if(d.minWidth||d.maxWidth){h=d.region=="left"?(k-d.offsetL):(d.offsetL-k);f=$("#"+d.resizeArea).width()+h;if(f<=d.minWidth||f>=d.maxWidth){return}}$("#"+d.resizeBarId).css({left:k+"px"})}}}catch(c){}finally{return false;k=null;i=null;h=null;f=null;b=null;a=null;j=null;d=null}};TableLayout.prototype.resizeEnd=function(k){var f=null,d=null,i=null,j=null,b=null,a=null,l=null,h=null,g=null;try{f=k.data.tbl;if(f.resizeMove){d=$("#"+f.resizeBarId);i=$("#"+f.resizeArea);if(f.type=="H"){j=parseInt(d.css("top"));b=f.region=="top"?(j-f.offsetT):(f.offsetT-j);a=parseInt(i.height())+b;i.css({height:a+"px"})}else{if(f.type=="V"){l=parseInt(d.css("left"));h=f.region=="left"?(l-f.offsetL):(f.offsetL-l);g=parseInt(i.width())+h;i.css({width:g+"px"})}}}}catch(c){}finally{f.resizeMove=false;$("#"+f.resizeBarId).hide();$("#tbl_resize_layer").hide();$(document).unbind("mousemove",f.resizeStart);$(document).unbind("mouseup",f.resizeEnd);j=null;b=null;a=null;l=null;h=null;g=null;d=null;i=null;f=null}};